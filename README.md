# Cluster BSS

## 完全稀疏、完全随机（不服从任何分布）数据

生成连续时间的初始信号 $S_{N \times T}$，其中的 $S[i][j]$ 表示时刻 $j$ 信号 $i$ 的强度，需要保证如下的稀疏性：

$$
\forall j, \exists k \in [1, N] \quad S[k][j] > 0, S[l][j] = 0, \forall l \neq k
$$

利用随机函数生成数据即可，所有数据在 $[0, 1)$ 范围内均匀取值。

- 稀疏性的机会是均等的，即上面的下标服 $k$ 从均匀分布
- 信号是完全稀疏的，保证只有一个信号有值
- 数据不服从任何分布

## Output 生成

根据等式：

$$
X_{M \times T} = A_{M \times N} S_{N \times T}, M < N
$$

给出 $A$ 和 $S$，计算出相应的 $X$

## 计算得到 $A$ 矩阵

首先我们要得到 $A$ 矩阵，这李要用到一个关键条件：『稀疏性』，假设在 $t$ 时刻的输入和输出分别为 $s_{N \times 1}$、$x_{M \times 1}$，而且由于稀疏性，只有 $s[2] \neq 0$，那么就有：

$$
x[m] = \sum_{k=1}^{N} A[m][k]s[k] = A[m][2]s[2]
$$

也就有：

$$
x = A[:][2]s[2]
$$

因此我们可以根据 $x$ 得到 $A$ 的第 $2$ 列的方向。

通过遍历样本数据，我们可以得到 $T$ 个方向向量，每个方向向量都满足 $A$ 中某一列的方向。

假设采样点是 100 个，那么我们可以得到 100 个方向向项，最终通过聚类可以得到 5 个中心方向向量作为最终的 $A$。

结果如下：

```txt
python cluster.py
A =
 [[ 1.  2.  3.  4.  5.]
 [ 6.  7.  8.  9. 10.]
 [ 5.  4.  3.  2.  1.]]
Estimated A =
 [[0.15384615 0.26666667 0.3125     0.08333333 0.21428571]
 [0.53846154 0.6        0.625      0.5        0.57142857]
 [0.30769231 0.13333333 0.0625     0.41666667 0.21428571]]
Normalized A =
 [[0.08333333 0.15384615 0.21428571 0.26666667 0.3125    ]
 [0.5        0.53846154 0.57142857 0.6        0.625     ]
 [0.41666667 0.30769231 0.21428571 0.13333333 0.0625    ]]
Normalized estimated A =
 [[0.15384615 0.26666667 0.3125     0.08333333 0.21428571]
 [0.53846154 0.6        0.625      0.5        0.57142857]
 [0.30769231 0.13333333 0.0625     0.41666667 0.21428571]]
```

## 根据 $A$ 得到 $S$

我们把 $A$ 写成列向量的形式：

$$
A = (a_1, a_2, a_3, a_4, a_5)
$$

每一列都是经过缩放的，我们将这 5 个列向量放到三维空间中，然后根据信号的稀疏性，我们只取其中离 $x$ 最近的三个向量作为基，得到 $s$ 在这三维中的信号值，这相当于求解一个三元一次方程组。最近的衡量方式是求内积并取绝对值。

比如在某一个时刻得到的信号 $x$ 离 $(a_1, a_3, a_5)$ 最近，我们计算：

$$
x = (a_1, a_3, a_5)s'
$$

再进一步得到 $s = (s'_1, 0, s'_3, 0, s'_5)$

很明显，$a_1, a_2, \cdots$ 的缩放只会影响到 $s$ 的分量中的幅值，而且每个时刻的缩放比例都是相同的。

## 改进的求解 $S$ 的方法

上面的做法得到的效果不太好，我们用另外一种方法求解，线性规划

```txt
x = (a_1, a_2, a_3, a_4, a_5)s
```

在下面的条件之下：

```txt
min |s|
```

## 保证还原信号的有序性

保证组合矩阵 $A$ 是按照某种方式排序的，估算出 $A$ 之后也按这种方式排序，得到与原始 $A$ 顺序一样的矩阵。

## 无法处理的情况

无法处理秩小于 $M$ 的矩阵。

## 扩展到非稀疏信号

对于非稀疏信号，我们的模型不能很好地处理，因此可以尝试将它们转换到另外一个稀疏的域上，在这个域上使用我们的模型得到结果之后再还原到时域上，就可以得到比较好的结果。